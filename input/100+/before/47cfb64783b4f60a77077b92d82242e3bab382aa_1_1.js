function(e){dc._charts.push(e)},dc.hasChart=function(e){return dc._charts.indexOf(e)>=0},dc.deregisterAllCharts=function(){dc._charts=[]},dc.filterAll=function(){for(var e=0;e<dc._charts.length;++e)dc._charts[e].filterAll()},dc.renderAll=function(){for(var e=0;e<dc._charts.length;++e)dc._charts[e].render()},dc.redrawAll=function(){for(var e=0;e<dc._charts.length;++e)dc._charts[e].redraw()},dc.baseChart=function(e){var t,n,r,i,s=0,o=0;return e.dimension=function(n){return arguments.length?(t=n,e):t},e.group=function(t){return arguments.length?(n=t,e):n},e.filterAll=function(){return e.filter(null)},e.dataAreSet=function(){return t!=undefined&&n!=undefined},e.select=function(e){return i.select(e)},e.selectAll=function(e){return i.selectAll(e)},e.anchor=function(t){return arguments.length?(r=t,i=d3.select(r),e):r},e.root=function(t){return arguments.length?(i=t,e):i},e.width=function(t){return arguments.length?(s=t,e):s},e.height=function(t){return arguments.length?(o=t,e):o},e.resetSvg=function(){e.select("svg").remove()},e.generateSvg=function(){return e.root().append("svg").data([e.group().top(Infinity)]).attr("width",e.width()).attr("height",e.height())},e},dc.pieChart=function(e){function h(){return d3.layout.pie().value(function(e){return e.value})}function p(e){e.innerRadius=c.innerRadius();var t=this._current;t==null&&(t={startAngle:0,endAngle:0});var n=d3.interpolate(t,e);return this._current=n(0),function(e){return u(n(e))}}var t=null,n=t,r="pie-slice",i=d3.scale.category20c(),s=0,o=0,u,a,f,l,c=dc.baseChart({});return c.render=function(){c.resetSvg();if(c.dataAreSet()){var e=c.generateSvg().append("g").attr("transform","translate("+c.cx()+","+c.cy()+")");a=h(),u=c.buildArcs();var t=c.drawSlices(e,a,u);c.drawLabels(t,u),c.highlightFilter()}return c},c.innerRadius=function(e){return arguments.length?(o=e,c):o},c.colors=function(e){return arguments.length?(i=e,c):i},c.radius=function(e){return arguments.length?(s=e,c):s},c.cx=function(){return c.width()/2},c.cy=function(){return c.height()/2},c.buildArcs=function(){return d3.svg.arc().outerRadius(s).innerRadius(o)},c.drawSlices=function(e,t,n){return f=e.selectAll("g."+r).data(t).enter().append("g").attr("class",r),l=f.append("path").attr("fill",function(e,t){return i(t)}).attr("d",n),l.transition().duration(750).attrTween("d",p),l.on("click",function(e){c.filter(e.data.key),c.highlightFilter(),dc.redrawAll()}),f},c.drawLabels=function(e,t){e.append("text").attr("transform",function(e){e.innerRadius=c.innerRadius(),e.outerRadius=s;var n=t.centroid(e);return isNaN(n[0])||isNaN(n[1])?"translate(0,0)":"translate("+n+")"}).attr("text-anchor","middle").text(function(e){var t=e.data;return t.value==0?"":t.key})},c.hasFilter=function(){return n!=t},c.filter=function(e){return arguments.length?(n=e,c.dataAreSet()&&c.dimension().filter(n),c):n},c.isSelectedSlice=function(e){return c.filter()==e.data.key},c.highlightFilter=function(){c.hasFilter()&&c.selectAll("g."+r).select("path").each(function(e){c.isSelectedSlice(e)?d3.select(this).attr("fill-opacity",1).attr("stroke","#ccc").attr("stroke-width",3):d3.select(this).attr("fill-opacity",.1).attr("stroke-width",0)})},c.redraw=function(){return f.selectAll("text").remove(),l=l.data(a(c.group().top(Infinity))),l.transition().duration(750).attrTween("d",p),c.drawLabels(f,u),c},dc.registerChart(c),c.anchor(e)},dc.barChart=function(e){function v(){a=a.scale(o).orient("bottom"),c.append("g").attr("class","axis x").attr("transform","translate("+s.left+","+O()+")").call(a)}function m(){f=f.scale(u).orient("left").ticks(t),c.append("g").attr("class","axis y").attr("transform","translate("+s.left+","+s.top+")").call(f)}function g(){d.on("brushstart",y).on("brush",b).on("brushend",w);var e=c.append("g").attr("class","brush").attr("transform","translate("+s.left+",0)").call(d.x(o));e.selectAll("rect").attr("height",O()),e.selectAll(".resize").append("path").attr("d",M),p&&C()}function y(e){}function b(e){i.filter([d.extent()[0],d.extent()[1]]),dc.redrawAll()}function w(e){}function E(){h=c.selectAll("rect.bar").data(i.group().all()),h.enter().append("rect").attr("class","bar").attr("x",function(e){return x(e)}).attr("y",O()).attr("width",function(){return S()}).transition().duration(r).attr("y",function(e){return T(e)}).attr("height",function(e){return N(e)}),h.transition().duration(r).attr("y",function(e){return T(e)}).attr("height",function(e){return N(e)}),h.exit().transition().duration(r).attr("y",O()).attr("height",0)}function S(){var e=Math.floor(i.width()/l(o.domain()[0],o.domain()[1]).length);if(isNaN(e)||e<n)e=n;return e}function x(e){return o(e.key)+s.left}function T(e){return s.top+u(e.value)}function N(e){return A()-u(e.value)}function C(){p&&d.empty()&&d.extent(p);var e=c.select("g.brush");e.call(d.x(o)),e.selectAll("rect").attr("height",O()),k()}function k(){if(!d.empty()&&d.extent()!=null){var e=d.extent()[0],t=d.extent()[1];h.classed("deselected",function(n){return n.key<=e||n.key>=t})}}function L(){return i.group().top(1)[0].value}function A(){return i.height()-s.top-s.bottom}function O(){return i.height()-s.bottom}function M(e){var t=+(e=="e"),n=t?1:-1,r=O()/3;return"M"+.5*n+","+r+"A6,6 0 0 "+t+" "+6.5*n+","+(r+6)+"V"+(2*r-6)+"A6,6 0 0 "+t+" "+.5*n+","+2*r+"Z"+"M"+2.5*n+","+(r+8)+"V"+(2*r-8)+"M"+4.5*n+","+(r+8)+"V"+(2*r-8)}var t=5,n=1,r=750,i=dc.baseChart({}),s={top:10,right:50,bottom:30,left:20},o,u=d3.scale.linear().range([100,0]),a=d3.svg.axis(),f=d3.svg.axis(),l,c,h,p,d=d3.svg.brush();return i.render=function(){return i.resetSvg(),i.dataAreSet()&&(c=i.generateSvg().append("g").attr("transform","translate("+s.left+","+s.top+")"),o.rangeRound([0,i.width()-s.left-s.right]),u.domain([0,L()]).rangeRound([A(),0]),E(),v(),m(),g()),i},i.redraw=function(){E(),C()},i.filter=function(e){return e?(p=e,d.extent(e),i.dimension().filterRange(e)):(p=null,d.clear(),i.dimension().filterAll()),i},i.margins=function(e){return arguments.length?(s=e,i):s},i.x=function(e){return arguments.length?(o=e,i):o},i.y=function(e){return arguments.length?(u=e,i):u},i.xUnits=function(e){return arguments.length?(l=e,i):l},i.axisX=function(e){return arguments.length?(a=e,i):a},i.axisY=function(e){return arguments.length?(f=e,i):f},i.transitionDuration=function(e){return arguments.length?(r=e,i):r},dc.registerChart(i),i.anchor(e)}