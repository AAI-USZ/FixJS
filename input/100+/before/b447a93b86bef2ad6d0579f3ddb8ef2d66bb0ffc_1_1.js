function(a){a.fn.highchartTable=function(){var d=["column","line","area","spline","pie"];var e=function(l,k){var m=a(l).data(k);if(typeof m!="undefined"){var h=m.split(".");var f=window[h[0]];for(var g=1,j=h.length;g<j;g++){f=f[h[g]]}return f}};this.each(function(){var x=a(this);var V=a(x);var S=1;var q=a("caption",x);var Q=q.length?a(q[0]).text():"";var O;if(V.data("graph-container-before")!=1){var T=V.data("graph-container");if(!T){throw"graph-container data attribute is mandatory"}if(T[0]==="#"||T.indexOf("..")===-1){O=a(T)}else{var z=x;var t=T;while(t.indexOf("..")!==-1){t=t.replace(/^.. /,"");z=z.parent()}O=a(t,z)}if(O.length!==1){throw"graph-container is not available in this DOM or available multiple times"}O=O[0]}else{V.before("<div></div>");O=V.prev();O=O[0]}var I=V.data("graph-type");if(!I){throw"graph-type data attribute is mandatory"}if(a.inArray(I,d)==-1){throw"graph-container data attribute must be one of "+d.join(", ")}var g=V.data("graph-stacking");if(!g){g="normal"}var o=V.data("graph-datalabels-enabled");var N=V.data("graph-inverted")==1;var y=a("thead th",x);var s=[];var A=[];var G=0;var F=false;y.each(function(ac,W){var af=a(W);var Y=af.data("graph-value-scale");var ab=af.data("graph-type");if(a.inArray(ab,d)==-1){ab=I}var i=af.data("graph-stack-group");if(i){F=true}var Z=af.data("graph-datalabels-enabled");if(typeof Z=="undefined"){Z=o}var aa=af.data("graph-yaxis");if(typeof aa!="undefined"&&aa=="1"){S=2}var ae=af.data("graph-skip")==1;if(ae){G=G+1}var X={libelle:af.text(),skip:ae,indexTd:ac-G-1,color:af.data("graph-color"),visible:!af.data("graph-hidden"),yAxis:typeof aa!="undefined"?aa:0,dashStyle:af.data("graph-dash-style")||"solid",dataLabelsEnabled:Z==1,dataLabelsColor:af.data("graph-datalabels-color")||V.data("graph-datalabels-color")};var ad=af.data("graph-vline-x");if(typeof ad=="undefined"){X.scale=typeof Y!="undefined"?parseFloat(Y):1;X.graphType=ab;X.stack=i;X.unit=af.data("graph-unit");s[ac]=X}else{X.x=ad;X.height=af.data("graph-vline-height");X.name=af.data("graph-vline-name");A[ac]=X}});var p=[];a(s).each(function(i,W){if(i!=0&&!W.skip){p.push({name:W.libelle+(W.unit?" ("+W.unit+")":""),data:[],type:W.graphType,stack:W.stack,color:W.color,visible:W.visible,yAxis:W.yAxis,dashStyle:W.dashStyle,marker:{enabled:false},dataLabels:{x:N?15:0,enabled:W.dataLabelsEnabled,color:W.dataLabelsColor,align:V.data("graph-datalabels-align")||"center"}})}});a(A).each(function(i,W){if(typeof W!="undefined"&&!W.skip){p.push({name:W.libelle,data:[{x:W.x,y:0,name:W.name},{x:W.x,y:W.height,name:W.name}],type:"spline",color:W.color,visible:W.visible,marker:{enabled:false}})}});var H=[];var h=e(x,"graph-point-callback");var M=V.data("graph-xaxis-type")=="datetime";var R=a("tbody:first tr",x);R.each(function(W,X){if(!!a(X).data("graph-skip")){return}var i=a("td",X);i.each(function(Y,ae){var al;var af=s[Y];if(af.skip){return}var Z=a(ae);if(Y==0){al=Z.text();H.push(al)}else{var aj=Z.text();var ah=p[af.indexTd];if(aj.length==0){ah.data.push(null)}else{var ab=aj.replace(/ /g,"").replace(/,/,".");al=Math.round(parseFloat(ab)*af.scale*100)/100;var ak=Z.data("graph-x");if(M){ak=a("td",a(X)).first().text();var aa=ak.split("-");var ad=c(aa);ak=ad.getTime()-ad.getTimezoneOffset()*60*1000}var ag=Z.data("graph-name");var ac={name:typeof ag!="undefined"?ag:aj,y:al,x:ak};if(h){ac.events={click:function(){return h(this)}}}if(af.graphType==="pie"){if(Z.data("graph-item-highlight")){ac.sliced=1}}var ai=Z.data("graph-item-color");if(typeof ai!="undefined"){ac.color=ai}ah.data.push(ac)}}})});var n=[];var D;for(D=1;D<=S;D++){var l={title:{text:typeof V.data("graph-yaxis-"+D+"-title-text")!="undefined"?V.data("graph-yaxis-"+D+"-title-text"):"Valeur"},max:typeof V.data("graph-yaxis-"+D+"-max")!="undefined"?V.data("graph-yaxis-"+D+"-max"):null,min:typeof V.data("graph-yaxis-"+D+"-min")!="undefined"?V.data("graph-yaxis-"+D+"-min"):null,reversed:V.data("graph-yaxis-"+D+"-reversed")=="1",opposite:V.data("graph-yaxis-"+D+"-opposite")=="1",tickInterval:V.data("graph-yaxis-"+D+"-tick-interval")||null,labels:{rotation:V.data("graph-yaxis-"+D+"-rotation")||0},startOnTick:V.data("graph-yaxis-"+D+"-start-on-tick")!=="0",endOnTick:V.data("graph-yaxis-"+D+"-end-on-tick")!=="0",stackLabels:{enabled:V.data("graph-yaxis-"+D+"-stacklabels-enabled")=="1"}};var L=e(x,"graph-yaxis-"+D+"-formatter-callback");if(L){l.labels.formatter=function(){return L(this.value)}}n.push(l)}var k=["#4572A7","#AA4643","#89A54E","#80699B","#3D96AE","#DB843D","#92A8CD","#A47D7C","#B5CA92"];var K=[];var v=typeof Highcharts.theme!="undefined"&&typeof Highcharts.theme.colors!="undefined"?Highcharts.theme.colors:[];var m=V.data("graph-line-shadow");var w=V.data("graph-line-width")||2;for(var P=0;P<9;P++){var E="graph-color-"+(P+1);K.push(typeof V.data(E)!="undefined"?V.data(E):typeof v[P]!="undefined"?v[P]:k[P])}var J=V.data("graph-margin-top");var U=V.data("graph-margin-right");var B=V.data("graph-margin-bottom");var r=V.data("graph-margin-left");var C=V.data("graph-xaxis-labels-enabled");var j={};var u=V.data("graph-xaxis-labels-font-size");if(typeof u!="undefined"){j.fontSize=u}var f={colors:K,chart:{renderTo:O,inverted:N,marginTop:typeof J!="undefined"?J:null,marginRight:typeof U!="undefined"?U:null,marginBottom:typeof B!="undefined"?B:null,marginLeft:typeof r!="undefined"?r:null,spacingTop:V.data("graph-spacing-top")||10,height:V.data("graph-height")||null,zoomType:V.data("graph-zoom-type")||null},title:{text:Q},subtitle:{text:V.data("graph-subtitle-text")||""},legend:{enabled:V.data("graph-legend-disabled")!="1",layout:V.data("graph-legend-layout")||"horizontal",symbolWidth:V.data("graph-legend-width")||30,x:V.data("graph-legend-x")||15,y:V.data("graph-legend-y")||0},xAxis:{categories:(V.data("graph-xaxis-type")!="datetime")?H:undefined,type:(V.data("graph-xaxis-type")=="datetime")?"datetime":undefined,reversed:V.data("graph-xaxis-reversed")=="1",opposite:V.data("graph-xaxis-opposite")=="1",showLastLabel:true,tickInterval:V.data("graph-xaxis-tick-interval")||null,dateTimeLabelFormats:{second:"%e. %b",minute:"%e. %b",hour:"%e. %b",day:"%e. %b",week:"%e. %b",month:"%e. %b",year:"%e. %b"},labels:{rotation:V.data("graph-xaxis-rotation")||0,align:V.data("graph-xaxis-align")||"center",enabled:typeof C!="undefined"?C:true,style:j},startOnTick:V.data("graph-xaxis-start-on-tick"),endOnTick:V.data("graph-xaxis-end-on-tick"),min:b(x,"min"),max:b(x,"max"),alternateGridColor:V.data("graph-xaxis-alternateGridColor")||null,title:{text:V.data("graph-xaxis-title-text")||null},gridLineWidth:V.data("graph-xaxis-gridLine-width")||0,gridLineDashStyle:V.data("graph-xaxis-gridLine-style")||"ShortDot"},yAxis:n,tooltip:{formatter:function(){if(V.data("graph-xaxis-type")=="datetime"){return"<b>"+this.series.name+"</b><br/>"+Highcharts.dateFormat("%e. %b",this.x)+" : "+this.y}else{var i=typeof H[this.point.x]!="undefined"?H[this.point.x]:this.point.x;return"<strong>"+this.series.name+"</strong><br />"+i+" : "+this.point.name}}},credits:{enabled:false},plotOptions:{line:{dataLabels:{enabled:true},lineWidth:w},area:{lineWidth:w,shadow:typeof m!="undefined"?m:true,fillOpacity:V.data("graph-area-fillOpacity")||0.75},pie:{allowPointSelect:true,dataLabels:{enabled:true},showInLegend:0,size:"80%"},series:{animation:false,stickyTracking:false,stacking:F?g:null,groupPadding:V.data("graph-group-padding")||0}},series:p,exporting:{filename:Q.replace(/ /g,"_"),buttons:{exportButton:{menuItems:null,onclick:function(){this.exportChart()}}}}};V.trigger("highchartTable.beforeRender",f);new Highcharts.Chart(f)});return this};var b=function(g,d){var h=a(g).data("graph-xaxis-"+d);if(typeof h!="undefined"){if(a(g).data("graph-xaxis-type")=="datetime"){var f=h.split("-");var e=c(f);return e.getTime()-e.getTimezoneOffset()*60*1000}return h}return null};var c=function(d){return new Date(parseInt(d[0],10),parseInt(d[1],10)-1,parseInt(d[2],10))}}