function(e){var b=[];function a(f,l,o){var n=1,i=10,k=l/2+i,h=f.clientY-k,j=f.clientY,g=e(window).height()-f.clientY,m=e(window).width()-f.clientX;if(k>j){h=i}else{if(k>g){h=e(window).height()-l-i}}if(m<o){n=m/o}return{position:h,ratio:n}}function d(g){var f;e(b).each(function(h,i){if(i.identifier(g)){f=i.handler(g);return false}});return f}function c(g,i,f){var h=a(g,f.height,f.width);e(i).css({top:h.position,left:g.pageX,width:f.width*h.ratio,height:f.height*h.ratio})}e.fn.zoomTooltip=function(g,h){b=g;var f=e.extend({smallImgClassName:"zt-small",zoomedImgClassName:"zt-zoomed",dbKeyDimensions:"originalDimensions",dbKeyZoomedImg:"zoomedImage",loader:"ajax-loader.gif",zoomedImageCss:{padding:"5px",background:"white"},loaderCss:{opacity:0.8,"border-radius":1,background:"white"}},h);e(this).parent().mousemove(function(j){if(!(e(j.target).hasClass(f.smallImgClassName)||e(j.target).hasClass(f.zoomedImgClassName))){var i=e("."+f.zoomedImgClassName).filter(":visible");i.fadeOut()}});e("*",this).each(function(i,k){var j=e(k);if(j.hasClass(f.smallImgClassName)||j.hasClass(f.zoomedImgClassName)){return}var l=d(j);if(l===undefined){return}j.mousemove(function(s){if(j.hasClass(f.smallImgClassName)){var n=e.data(j,f.dbKeyZoomedImg);var p=e.data(j,f.dbKeyDimensions);if(p===undefined){return}c(s,n,p);if(!n.is(":visible")){n.fadeIn()}}else{var m=e("<img />",{src:f.loader,alt:"Loading..."}),r=e("<img />",{"class":f.zoomedImgClassName,src:l,alt:""}),q=e("body");m.load(function(){e(this).css(e.extend({position:"absolute",top:j.offset().top+2,left:j.offset().left+j.width()-e(this).width()-2},f.loaderCss))});q.append(m);q.append(r);r.load(function(){e.data(j,f.dbKeyDimensions,{width:e(this).width(),height:e(this).height()});e(this).css(e.extend({position:"absolute",zIndex:999},f.zoomedImageCss));c(s,this,e.data(j,f.dbKeyDimensions));m.remove()});var o={xMin:j.offset().left,xMax:j.offset().left+e(this).width(),yMin:j.offset().top,yMax:j.offset().top+e(this).height()};r.mousemove(function(t){if(t.pageX<o.xMin||t.pageX>o.xMax||t.pageY<o.yMin||t.pageY>o.yMax){e(this).fadeOut();return}c(t,this,e.data(j,f.dbKeyDimensions))});j.addClass(f.smallImgClassName);e.data(j,f.dbKeyZoomedImg,r)}})})}}