function(a){a.fn.bAutoSize=function(c,d){return this.each(function(){var e=a(this);f=e.data("bAutoSize");if(f){if(typeof f[d]=="function")f[d].call();return e.data("bAutoSize")}var f=new b(this,c);e.data("bAutoSize",f)})};var b=function(b,c){var d=a(b);var e=this;var f={w:null,h:null};var g=a.extend({parent:a(d).parent(),trigger_at_load:true,trigger_minimum:20,width_offset:0,height_offset:0,width_perc:1,height_perc:1,minimum:false,maximum:false,height_proportion:false,callback:null,callback_env:null,resize_children:false,debug:false},c||{});this.init=function(){g.ignored_height+=a("#header").outerHeight();if(g.trigger_at_load){e.resize(true)}a(window).resize(function(){a(d).bAutoSize(false,"resize")})};this.resize=function(b){ww=Math.floor(g.parent.width());hh=Math.floor(g.parent.height());if(g.debug){console.log("autoresize for #"+d.attr("id"));console.log("parent.w : "+ww+" parent.h : "+hh)}if(!b&&Math.abs(ww-f.w)<g.trigger_minimum&&Math.abs(hh-f.h)<g.trigger_minimum){return false}f.w=ww;f.h=hh;new_width=Math.floor((ww-g.width_offset)*g.width_perc);new_height=Math.floor((hh-g.height_offset)*g.height_perc);if(g.height_proportion){g.debug?console.log("enforced proportion h"+g.height_proportion):true;old_height=new_height;new_height=Math.floor(new_width*g.height_proportion);if(new_height>old_height){new_width=Math.floor(new_width*(old_height/new_height));new_height=Math.floor(new_width*g.height_proportion)}}if(g.minimum){if(typeof g.minimum.w!=="undefined"&&new_width<g.minimum.w){g.debug?console.log("enforced minimum w"+g.minimum.w):true;new_width=Math.max(new_width,g.minimum.w)}if(typeof g.minimum.h!=="undefined"&&new_height<g.minimum.h){g.debug?console.log("enforced minimum h"+g.minimum.h):true;new_height=Math.max(new_height,g.minimum.h)}}if(g.maximum){if(typeof g.maximum.w!=="undefined"&&new_width>g.maximum.w){g.debug?console.log("enforced maximum w"+g.maximum.w):true;new_width=Math.min(new_width,g.maximum.w)}if(typeof g.maximum.h!=="undefined"&&new_height>g.maximum.h){g.debug?console.log("enforced maximum h"+g.maximum.h):true;new_height=Math.min(new_height,g.maximum.h)}}d.width(new_width);d.height(new_height);if(g.resize_children){a(d).children().each(function(b,c){a(c)[0].width=new_width;a(c)[0].height=new_height})}if(typeof g.callback=="function")g.callback.call(g.callback_env?g.callback_env:false);if(g.debug)console.log("elem.w : "+new_width+" elem.h : "+new_height);return true};a(document).ready(this.init)}}