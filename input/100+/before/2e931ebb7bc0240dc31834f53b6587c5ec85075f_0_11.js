function(a,b){if(typeof a!="undefined"){m={};m=a;s=b;VMM.attachElement(r,"");E=VMM.appendAndGetElement(r,"<div>","timenav");$=VMM.appendAndGetElement(E,"<div>","content");U=VMM.appendAndGetElement(E,"<div>","time");ga=VMM.appendAndGetElement(U,"<div>","time-interval-minor");Y=VMM.appendAndGetElement(ga,"<div>","minor");X=VMM.appendAndGetElement(U,"<div>","time-interval-major");W=VMM.appendAndGetElement(U,"<div>","time-interval");
P=VMM.appendAndGetElement(r,"<div>","timenav-background");da=VMM.appendAndGetElement(P,"<div>","timenav-line");ea=VMM.appendAndGetElement(P,"<div>","timenav-indicator");VMM.appendAndGetElement(P,"<div>","timenav-interval-background","<div class='top-highlight'></div>");Q=VMM.appendAndGetElement(r,"<div>","toolbar");o=R(m[m.length-1].enddate-m[0].startdate,true);trace(o);var c=R(m[0].startdate),i=R(m[m.length-1].enddate);K.type="millenium";K.first=c.milleniums;K.base=Math.floor(c.milleniums);K.last=
i.milleniums;K.number=o.milleniums;K.multiplier=1E3;K.minor=1E3;D.type="century";D.first=c.centuries;D.base=Math.floor(c.centuries);D.last=i.centuries;D.number=o.centuries;D.multiplier=100;D.minor=100;N.type="decade";N.first=c.decades;N.base=Math.floor(c.decades);N.last=i.decades;N.number=o.decades;N.multiplier=10;N.minor=10;H.type="year";H.first=c.years;H.base=Math.floor(c.years);H.last=i.years;H.number=o.years;H.multiplier=1;H.minor=12;A.type="month";A.first=c.months;A.base=Math.floor(c.months);
A.last=i.months;A.number=o.months;A.multiplier=1;A.minor=Math.round(4.34812141);B.type="day";B.first=c.days;B.base=Math.floor(c.days);B.last=i.days;B.number=o.days;B.multiplier=1;B.minor=24;I.type="hour";I.first=c.hours;I.base=Math.floor(c.hours);I.last=i.hours;I.number=o.hours;I.multiplier=1;I.minor=60;F.type="minute";F.first=c.minutes;F.base=Math.floor(c.minutes);F.last=i.minutes;F.number=o.minutes;F.multiplier=1;F.minor=60;J.type="decade";J.first=c.seconds;J.base=Math.floor(c.seconds);J.last=i.seconds;
J.number=o.seconds;J.multiplier=1;J.minor=10;if(o.centuries>m.length/l.nav.density){u=D;v=K}else if(o.decades>m.length/l.nav.density){u=N;v=D}else if(o.years>m.length/l.nav.density){u=H;v=N}else if(o.months>m.length/l.nav.density){u=A;v=H}else if(o.days>m.length/l.nav.density){u=B;v=A}else if(o.hours>m.length/l.nav.density){u=I;v=B}else if(o.minutes>m.length/l.nav.density){u=F;v=I}else if(o.seconds>m.length/l.nav.density){u=J;v=F}else{trace("NO IDEA WHAT THE TYPE SHOULD BE");u=B;v=A}trace("INTERVAL TYPE: "+
u.type);trace("INTERVAL MAJOR TYPE: "+v.type);ha(u,z,W);ha(v,y,X);k=[];w=[];c=["#F9FFE5","#E5EFFF","#E5FFEF","#EFEFEF","#FFF1E5"];for(i=0;i<m.length;i++){var L,p,t,O,M="",G=false;p=VMM.appendAndGetElement($,"<div>","marker");t=VMM.appendAndGetElement(p,"<div>","flag");L=c[0];if(typeof m[i].colorIndexId!="undefined"){O=m[i].colorIndexId;O<c.length&&(L=c[O])}t.attr("style","background-color:"+L+";");L=VMM.appendAndGetElement(t,"<div>","flag-content");VMM.appendAndGetElement(p,"<div>","dot");O=VMM.appendAndGetElement(p,
"<div>","line");O=VMM.appendAndGetElement(O,"<div>","event-line");_marker_relative_pos=ca(u,m[i].startdate,m[i].enddate);_marker_thumb="";m[i].asset!=null&&m[i].asset!=""?VMM.appendElement(L,VMM.MediaElement.thumbnail(m[i].asset,24,24,m[i].uniqueid)):VMM.appendElement(L,"<div style='margin-right:7px;height:50px;width:2px;float:left;'></div>");if(m[i].title==""||m[i].title==" "){trace("TITLE NOTHING");if(typeof m[i].slug!="undefined"&&m[i].slug!=""){trace("SLUG");M=VMM.Util.untagify(m[i].slug);G=true}else{var S=
VMM.MediaType(m[i].asset.media);if(S.type=="quote"||S.type=="unknown"){M=VMM.Util.untagify(S.id);G=true}else if(S.type=="twitter"){G=false;VMM.appendElement(L,"<h3 id='text_thumb_"+S.id+"'>"+M+"</h3>")}else G=false}}else if(m[i].title!=""||m[i].title!=" "){trace(m[i].title);M=VMM.Util.untagify(m[i].title);G=true}else trace("TITLE SLUG NOT FOUND "+m[i].slug);G&&VMM.appendElement(L,"<h3>"+M+"</h3>");VMM.Lib.attr(p,"id",("marker_"+m[i].uniqueid).toString());VMM.bindEvent(t,g,"",{number:i});VMM.bindEvent(t,
h,"mouseenter mouseleave",{number:i,elem:t});p={marker:p,flag:t,lineevent:O,type:"marker",relative_pos:_marker_relative_pos,tag:m[i].tag};if(m[i].type=="start"){trace("BUILD MARKER HAS START PAGE");l.start_page=true;p.type="start"}if(m[i].type=="storify")p.type="storify";m[i].tag&&q.push(m[i].tag);k.push(p)}q=VMM.Util.deDupeArray(q);for(c=0;c<q.length;c++)if(c<l.nav.rows.length){i=VMM.appendAndGetElement(P,"<div>","timenav-tag");VMM.Lib.addClass(i,"timenav-tag-row-"+(c+1));VMM.appendElement(i,"<div><h3>"+
q[c]+"</h3></div>")}for(c=0;c<s.length;c++){i={content:VMM.appendAndGetElement($,"<div>","era"),startdate:VMM.Util.parseDate(s[c].startDate),enddate:VMM.Util.parseDate(s[c].endDate),title:s[c].headline,uniqueid:VMM.Util.unique_ID(4),color:s[c].color,relative_pos:""};i.relative_pos=ca(u,s[c].startdate,s[c].enddate);VMM.Lib.attr(i.content,"id",i.uniqueid);VMM.Lib.css(i.content,"background",i.color);VMM.appendElement(i.content,"<h3>"+VMM.Util.unlinkify(i.title)+"</h3>");w.push(i)}c=l.nav.multiplier.current;
for(i=0;i<c;i++){G=p=G=0;t=[];for(M=0;M<k.length;M++)if(m[M].type!="start"){L=Z(u,k[M].relative_pos);G=p;p=L.begin;G=p-G;t.push(G)}if(VMM.Util.average(t).mean<75&&l.nav.multiplier.current>1)l.nav.multiplier.current=l.nav.multiplier.current-1}ia();T(W,z,false,true);T(X,y);if(l.start_page){$backhome=VMM.appendAndGetElement(Q,"<div>","back-home","<div class='icon'></div>");VMM.bindEvent(".back-home",j,"click");VMM.Lib.css(Q,"top",27);VMM.Lib.attribute($backhome,"title",VMM.master_config.language.messages.return_to_title);
VMM.Lib.attribute($backhome,"rel","tooltip")}aa=VMM.appendAndGetElement(Q,"<div>","zoom-in","<div class='icon'></div>");ba=VMM.appendAndGetElement(Q,"<div>","zoom-out","<div class='icon'></div>");VMM.Lib.attribute(aa,"title",VMM.master_config.language.messages.expand_timeline);VMM.Lib.attribute(aa,"rel","tooltip");VMM.Lib.attribute(ba,"title",VMM.master_config.language.messages.contract_timeline);VMM.Lib.attribute(ba,"rel","tooltip");Q.tooltip({selector:"div[rel=tooltip]",placement:"right"});if(VMM.Browser.device==
"mobile"||VMM.Browser.device=="tablet"){VMM.TouchSlider.createPanel(P,E,l.width,l.spacing,false);VMM.bindEvent(E,n,"TOUCHUPDATE")}else VMM.DragSlider.createPanel(r,E,l.width,l.spacing,false);VMM.bindEvent(".zoom-in",e,"click");VMM.bindEvent(".zoom-out",f,"click");VMM.fireEvent(r,"LOADED");d(!x);x=true}else trace("NO DATA")};this.setSize=function(a,b){if(a!=null)l.width=a;if(b!=null)l.height=b;x&&d()};this.setMarker=function(a,b,c,d){V(a,b,c,d)};this.getCurrentNumber=function(){return C}