function(e,t,n){"use strict";e.fn.mobileBox=function(r){var i={counter:"{i} of {t}",isTouch:"ontouchstart"in t.documentElement};e.extend(i,r),e(this).addClass("_mobileBox"),e(this).click(function(t){e("#mobileBoxViewport").length?e("#mobileBoxViewport").attr("content","width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0;"):e("head").append('<meta name="viewport" id="mobileBoxViewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0;" />'),o=n.innerHeight,s=n.innerWidth;if(!i.isTouch)return;var r=e(this).attr("href"),u=e(this).attr("title"),h=e(this).attr("class").split(" "),p=new Image;p.src=r;var d=[];for(var v=0;v<h.length;v++){var m=h[v];if(m==="_mobileBox")continue;var g=e("."+m);for(var y=0;y<g.length;y++){var b=g[y];d.indexOf(b)===-1&&d.push(b)}}var w=e(d).index(this);return f(p,function(t,n,s){var o=d.length?d.length:1,f=i.counter.replace("{i}",w+1).replace("{t}",o),h=e(a.replace("{src}",r).replace("{title}",u).replace("{counter}",f));e(".mobileBox",h).append(this),e(".mobileBoxDone a",h).bind("click",l),e("body").prepend(h),c(e(".mobileBox"),d,w)}),!1});var s=0,o=0,u="landscape",a=['<div class="mobileBoxWrapper">','<div class="mobileBoxBg"></div>','<div class="mobileBox">','<div class="mobileBoxHeader">','<span class="mobileBoxDone"><a href="#done">Done</a></span>','<span class="mobileBoxCounter">{counter}</span>',"</div>",'<div class="mobileBoxTitle">{title}</div>',"</div>","<div>"].join(""),f=function(t,n){e(t).load(function(r){var i=r.currentTarget;i.width<i.height&&(u="portrait");var a=o-i.height;a=a>=0?a/4:0;if(i.width<s){e(t).css({width:i.width+"px"});var f=(s-i.width)/2;e(t).css({"margin-left":"0px"})}i.height>i.width&&i.height>o&&e(t).css({width:"auto",height:o-100+"px"}),e(t).css({"margin-top":a+"px"}),n.call(t,i.width,i.height,a)})},l=function(){return e(".mobileBoxWrapper").fadeOut(function(){n.location=n.location}),!1},c=function(t,n,r){function c(e){var t=e.originalEvent.targetTouches[0];u.x=t.pageX,u.y=t.pageY}function h(e){var t=e.originalEvent.targetTouches[0];a.x=t.pageX,a.y=t.pageY,e.preventDefault()}function p(){}function d(){var e=u.y-a.y,t,n=l.threshold,r=n.y,s=n.x;e<r&&e>-r&&(t=u.x-a.x,t>s?l.swipeLeft.call(i):t<-s&&l.swipeRight.call(i))}var i=t,o=function(t){if(r+t>=0&&r+t<n.length){var i=r+t,o=e(n[i]);e(".mobileBox img").animate({left:(t<0?"+":"-")+"="+s},200,function(){e(this).remove()});var u=new Image;u.src=o.attr("href"),f(u,function(r,u,a){var f={},l=0;r<s&&(l=(s-r)/2),t>0?(e(this).css({right:"-"+s+"px"}),f.right="0px"):(e(this).css({left:"-"+s+"px"}),f.left="0px"),e(".mobileBoxTitle").html(o.attr("title")),e(".mobileBoxCounter").html(i+1+" of "+n.length),e(".mobileBox").append(this),e(this).animate(f,200)}),r+=t}},u={x:0,y:0},a={x:0,y:0},l={threshold:{x:10,y:100},swipeLeft:function(){o(1)},swipeRight:function(){o(-1)}};e(i).bind("touchstart.swipe",c).bind("touchmove.swipe",h).bind("touchend.swipe",d).bind("touchcancel.swipe",p)}}}