function(){var e,t,n;n=this,t=n.Artemis,e=void 0,typeof exports!="undefined"?e=exports:(e=t={},n.Artemis=e),e.VERSION="0.0.1"}).call(this),function(){var e;Artemis.Entity={},e=function(){function e(e,t){this.world=e,this.id=t,this.typeBits=0,this.systemBits=0}return e.prototype["delete"]=function(){return this.world.deleteEntity(this)},e.prototype.addComponent=function(e){if(e instanceof Artemis.Component)return this.world.entityManager._addComponent(this,e),null;throw new Error("Tried to add a component that is not inheriting from Component")},e.prototype.removeComponent=function(e){return this.world.entityManager._removeComponent(this,e),null},e.prototype.getComponent=function(e){return this.world.entityManager._getComponent(this,e)},e.prototype.refresh=function(){return this.world.refreshEntity(this)},e.prototype._addTypeBit=function(e){return this.typeBits|=e},e.prototype._removeTypeBit=function(e){return this.typeBits&=~e},e.prototype._addSystemBit=function(e){return this.systemBits|=e},e.prototype._removeSystemBit=function(e){return this.systemBits&=~e},e.prototype.isActive=function(){return this.world.entityManager._isActive(this.id)},e.prototype.setGroup=function(e){return this.world.groupManager.set(e,this)},e.prototype.setTag=function(e){return this.world.tagManager.register(e,this)},e.prototype.getComponents=function(){},e}(),Artemis.Entity=e}.call(this),function(){var e,t=[].slice;Artemis.System={},e=function(){function e(){var e,n,r,i,s;n=1<=arguments.length?t.call(arguments,0):[],this.world=null,this.actives={},this.enabled=!0,this.bit=0,this.typeFlags=0;for(i=0,s=n.length;i<s;i++)e=n[i],r=Artemis.ComponentTypeManager.getTypeByName(e),this.typeFlags|=r.bit}return e.prototype.initialize=function(){},e.prototype.processEntities=function(e){},e.prototype.begin=function(){},e.prototype.end=function(){},e.prototype.process=function(){if(this.enabled)return this.begin,this.processEntities(this.actives),this.end},e.prototype.change=function(e){var t,n;t=(this.bit&e.systemBits)===this.systemBit,n=(this.typeFlags&e.typeBits)===this.typeFlags;if(n&&!t&&this.typeFlags>0)return this.actives[e.id]=e,e._addSystemBit(this.bit),this.added(e);if(!n&&t&&this.typeFlags>0)return this.remove(e)},e.prototype.remove=function(e){return delete this.actives[e.id],e._removeSystemBit(this.bit),this.removed(e)},e.prototype.added=function(e){},e.prototype.removed=function(e){},e}(),Artemis.System=e}.call(this),function(){var e,t=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};Artemis.SystemManager={},e=function(){function r(e){this.world=e,this.systems={},this.allSystems=[]}var e,n;return n={},e=0,r.prototype._getBitFor=function(t){var r;return r=n[t],r||(r=1<<e,e+=1,n[t]=r),r},r.prototype.addSystem=function(e){return e.world=this.world,this.systems[e.constructor.name]=e,t.call(this.allSystems,e)<0&&this.allSystems.push(e),e.bit=this._getBitFor(e.constructor.name),e},r.prototype.getSystem=function(e){return this.systems[e]},r.prototype.initializeAll=function(){var e,t,n,r,i;r=this.allSystems,i=[];for(t=0,n=r.length;t<n;t++)e=r[t],i.push(e.initialize());return i},r}(),Artemis.SystemManager=e}.call(this),function(){var e;Artemis.Component={},e=function(){function e(){}return e}(),Artemis.Component=e}.call(this),function(){var e;Artemis.ComponentMapper={},e=function(){function e(e,t){this.world=t,this.em=t.entityManager,this.componentName=e}return e.prototype.get=function(e){return this.em._getComponent(e,this.componentName)},e}(),Artemis.ComponentMapper=e}.call(this),function(){var e;Artemis.ComponentType={},e=function(){function n(){this.id=t,t++,this.bit=e,e<<=1}var e,t;return t=0,e=1,n}(),Artemis.ComponentType=e}.call(this),function(){var e;Artemis.ComponentTypeManager={},e=function(){function t(){}var e;return e={},t.getType=function(t){var n,r;if(t instanceof Artemis.Component)return n=t.constructor.name,r=e[n],r||(r=new Artemis.ComponentType,e[n]=r),r;throw new Error("Tried to add a component that is not inheriting from Component")},t.getTypeByName=function(t){var n;return n=e[t],n||(n=new Artemis.ComponentType,e[t]=n),n},t.getId=function(e){return this.getType(e).id},t.getBit=function(e){return this.getType(e).bit},t}(),Artemis.ComponentTypeManager=e}.call(this),function(){var e;Artemis.EntityManager={},e=function(){function e(e){this.world=e,this.entities={},this.componentsByType={},this.nextId=0,this.count=0,this.totalCreated=0}return e.prototype._create=function(){var e;return e=new Artemis.Entity(this.world,this.nextId),this.nextId++,this.entities[e.id]=e,this.count++,this.totalCreated++,e},e.prototype._getEntity=function(e){return this.entities[e]},e.prototype.refresh=function(e){var t,n,r,i,s;i=this.world.systemManager.allSystems,s=[];for(n=0,r=i.length;n<r;n++)t=i[n],s.push(t.change(e));return s},e.prototype.remove=function(e){return delete this.entities[e.id],this._removeAllComponents(e),this.count--,e=null},e.prototype._isActive=function(e){return this.entities[e]?!0:!1},e.prototype._addComponent=function(e,t){var n,r;return n=Artemis.ComponentTypeManager.getType(t),r=this.componentsByType[n.id],r||(r={},this.componentsByType[n.id]=r),r[e.id]=t,e._addTypeBit(n.bit)},e.prototype._removeComponent=function(e,t){var n,r;return n=Artemis.ComponentTypeManager.getTypeByName(t),r=this.componentsByType[n.id],delete r[e.id],e._removeTypeBit(n.bit)},e.prototype._getComponent=function(e,t){var n,r;return n=Artemis.ComponentTypeManager.getTypeByName(t),r=this.componentsByType[n.id],r?r[e.id]:null},e.prototype._getAllComponents=function(e){var t,n,r,i,s;t=[],s=this.componentsByType;for(i in s)r=s[i],r&&(n=r[e.id],n&&t.push(n));return t},e.prototype._removeAllComponents=function(e){var t,n,r,i;r=this.componentsByType,i=[];for(n in r)t=r[n],e.id in t?(delete t[e.id],Object.keys(t).length===0?i.push(delete this.componentsByType[n]):i.push(void 0)):i.push(void 0);return i},e}(),Artemis.EntityManager=e}.call(this),function(){var e,t={}.hasOwnProperty,n=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};Artemis.EntityProcessingSystem={},e=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return n(t,e),t.prototype.construct=function(){return t.__super__.construct.apply(this,arguments)},t.prototype.processEntity=function(e){},t.prototype.processEntities=function(e){var t,n,r;r=[];for(n in e)t=e[n],r.push(this.processEntity(t));return r},t}(Artemis.System),Artemis.EntityProcessingSystem=e}.call(this),function(){var e,t=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};Artemis.EntityWorld={},e=function(){function e(){this.entityManager=new Artemis.EntityManager(this),this.systemManager=new Artemis.SystemManager(this),this.tagManager=new Artemis.TagManager(this),this.groupManager=new Artemis.GroupManager(this),this.deleted=[],this.refreshed=[],this.delta=0}return e.prototype.createEntity=function(){return this.entityManager._create()},e.prototype.getEntity=function(e){return this.entityManager._getEntity(e)},e.prototype.deleteEntity=function(e){if(t.call(this.deleted,e)<0)return this.deleted.push(e)},e.prototype.refreshEntity=function(e){return this.refreshed.push(e)},e.prototype.loopStart=function(){var e,t,n,r,i,s,o;s=this.refreshed;for(t=0,r=s.length;t<r;t++)e=s[t],this.entityManager.refresh(e);this.refreshed=[],o=this.deleted;for(n=0,i=o.length;n<i;n++)e=o[n],this.entityManager.remove(e);return this.deleted=[]},e}(),Artemis.EntityWorld=e}.call(this),function(){var e;Artemis.GroupManager={},e=function(){function e(e){this.world=e,this.entitiesByGroup={},this.groupByEntity={}}return e.prototype.set=function(e,t){var n;return this.remove(t),n=this.entitiesByGroup[e],n||(n=[],this.entitiesByGroup[e]=n),n.push(t),this.groupByEntity[t.id]=e},e.prototype.get=function(e){return this.entitiesByGroup[e]},e.prototype.remove=function(e){var t,n,r;if(e.id in this.groupByEntity){n=this.groupByEntity[e.id],delete this.groupByEntity[e.id],t=this.entitiesByGroup[n];if(t){r=t.indexOf(e),t.splice(r,1);if(t.length===0)return delete this.entitiesByGroup[n]}}},e}(),Artemis.GroupManager=e}.call(this),function(){var e;Artemis.TagManager={},e=function(){function e(e){this.world=e,this.taggedEntities={}}return e.prototype.register=function(e,t){return this.taggedEntities[e]=t,null},e.prototype.unregister=function(e){return delete this.taggedEntities[e]},e.prototype.get=function(e){return this.taggedEntities[e]},e.prototype.isRegistered=function(e){return e in this.taggedEntities},e}(),Artemis.TagManager=e}