function(a){if(a=="\n")return false;a=JSON.parse(a);a.id==b.document&&a.changes.pop().rev!=this.get("_rev")&&(a.deleted?e.event("deleteDoc"):e.event("updateDoc"))},this)},subscribeToBulkChanges:function(a){h.mixin({feed:"continuous",heartbeat:2E4,since:a,include_docs:true},b.query);this.stopListening=f.listen("CouchDB",{path:"/"+b.database+"/_changes",query:b.query},function(b){if(b=="\n")return false;var b=JSON.parse(b),a;a=b.changes[0].rev.search("1-")==
0?"bulkAdd":b.deleted?"delete":"bulkChange";e.event(a,b.id,b.doc)},this)},updateDocInStore:function(a){f.request("CouchDB",{method:"GET",path:"/"+b.database+"/_design/"+b.design+"/"+b.view,query:b.query},function(b){b=JSON.parse(b);b.rows.length==this.getNbItems()?b.rows.some(function(b,g){b.id==a&&this.set(g,b)},this):this.actions.evenDocsInStore.call(this,b.rows,a)},this)},evenDocsInStore:function(b,a){var g=this.getNbItems();b.length<g?this.loop(function(b,g){b.id==a&&this.del(g)}