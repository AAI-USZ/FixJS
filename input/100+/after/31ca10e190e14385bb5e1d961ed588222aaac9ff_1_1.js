function(e){function t(t,n,r){t[n]?t[n].apply(r):e.visualize.plugins[n]?e.visualize.plugins[n].apply(r):e.getScript("./js/plugins/jquery.visualize."+n.split(/[-_]/)[0]+".js",function(){e.visualize.plugins[n].apply(r)}).fail(function(e,t,i){r.target.canvasContainer.remove(),console.log&&console.log("Failed to load jquery.vizualize plugin "+n+" in following location : ./js/plugins/jquery.visualize."+n.split(/[-_]/)[0]+".js\n"+i)})}function n(t,n){this.table=e(t),this.options=n,this._headers={x:[],y:[]}}e.visualize={plugins:{}},Array.max=function(e){return Math.max.apply(Array,e)},Array.min=function(e){return Math.min.apply(Array,e)},Array.sum=function(e){var t=e&&e.length?e.length:0,n=0,r;for(var i=0;i<t;i++)r=parseFloat(e[i]),n+=!e[i]||isNaN(e[i])?0:r;return n},Array.avg=function(e){var t=e&&e.length?e.length:0;return t?Array.sum(e)/t:0},e.visualize.getRangeLabels=function(e,t,n){var n=n||5,r=n-1,i=t-e,s=[];s.push(e);for(var o=1;o<r;o++)s.push(Math.ceil(e+i/r*o));return s.push(t),s},n.prototype={parse:function(){if(this.parsed)return this;var t=this.options.rowFilter,n=this.options.colFilter,r=[],i=[],s=[];e("tr",this.table).filter(t).each(function(t,o){var u=[];e("th, td",e(o)).filter(n).each(function(n,r){u.push(t==0||n==0?e(r).text():parseFloat(e(r).text()))}),t==0?(u.shift(),s=u):(i.push(u.shift()),r.push(u))});var o=r.length,u=r[0].length,a=[];for(var f=0;f<u;f++){var l=[];for(var c=0;c<o;c++)l.push(r[c][f]);a.push(l)}return this.lineHeaders=i,this.columnHeaders=s,this.lines=r,this.columns=a,this.parsed=!0,this},dataGroups:function(){if(this._dataGroups)return this._dataGroups;var t=[],n=this.options.colors,r=this.options.textColors,i=this.options.rowFilter,s=this.options.colFilter;if(this.options.parseDirection=="x")this.table.find("tr:gt(0)").filter(i).each(function(i,o){t[i]={},t[i].points=[],t[i].points_weight=[],t[i].color=n[i],r[i]&&(t[i].textColor=r[i]),e(o).find("td").filter(s).each(function(){var n=e(this).text().split(";");t[i].points.push(n.length>0?parseFloat(n[0]):0),t[i].points_weight.push(n.length>1?parseFloat(n[1]):1)})});else{var o=this.table.find("tr:eq(1) td").filter(s).size();for(var u=0;u<o;u++)t[u]={},t[u].points=[],t[u].points_weight=[],t[u].color=n[u],r[u]&&(t[u].textColor=r[u]),this.table.find("tr:gt(0)").filter(i).each(function(){var n=e(this).find("td").filter(s).eq(u).text().split(";");t[u].points.push(n.length>0?parseFloat(n[0]):0),t[u].points_weight.push(n.length>1?parseFloat(n[1]):1)})}return this._dataGroups=t},allData:function(){if(this._allData)return this._allData;var t=[];return e(this.dataGroups()).each(function(){t.push.apply(t,this.points)}),this._allData=t},dataSum:function(){return this._dataSum?this._dataSum:this._dataSum=Array.sum(this.allData())},topValue:function(){return this._topValue?this._topValue:this._topValue=Array.max(this.allData())},bottomValue:function(){return this._bottomValue?this._bottomValue:this._bottomValue=Array.min(this.allData())},memberTotals:function(){if(this._memberTotals)return this._memberTotals;var t=[],n=this.dataGroups();return e.each(n,function(e,n){t.push(Array.sum(n.points))}),this._memberTotals=t},groupSums:function(){if(this._groupSums)return this._groupSums;var e=[],t=this.dataGroups();for(var n=0;n<t.length;n++){var r=t[n].points;for(var i=0;i<r.length;i++)typeof e[i]=="undefined"&&(e[i]=0),e[i]+=parseFloat(r[i])}return this._groupSums=e},totalYRange:function(){return this.topValue()-this.bottomValue()},xLabels:function(){return this.parseHeaders(this.options.parseDirection)},keys:function(){return this.parseHeaders(this.options.parseDirection=="x"?"y":"x")},parseHeaders:function(t){var n=this._headers[t];return n.length?n:(t=="x"?this.table.find("tr:eq(0) th").filter(this.options.colFilter).each(function(t,r){n.push(e(r).html())}):this.table.find("tr:gt(0) th").filter(this.options.rowFilter).each(function(t,r){n.push(e(r).html())}),n)},yLabels:function(t,n){var r=this.options.ticks||Math.round(this.options.height/this.options.yLabelInterval);return e.visualize.getRangeLabels(t,n,r)},yLabels100:function(){return e.visualize.getRangeLabels(0,100,5)}},e.fn.visualize=function(r,i){return typeof r=="string"&&(r=e.extend({},i,{type:r}),i=arguments[2]),e(this).each(function(){var s=e(this),o=e.extend({type:"bar",width:s.width(),height:s.height(),appendTitle:!0,title:null,appendKey:!0,rowFilter:" ",colFilter:" ",colors:["#be1e2d","#666699","#92d5ea","#ee8310","#8d10ee","#5a3b16","#26a4ed","#f45a90","#e9e744"],textColors:[],parseDirection:"x",pieMargin:20,pieLabelsAsPercent:!0,pieLabelPos:"inside",lineWeight:4,barGroupMargin:10,barMargin:1,yLabelInterval:30},r),u=o.width=parseFloat(o.width),a=o.height=parseFloat(o.height),f={pie:function(){h.addClass("visualize-pie"),o.pieLabelPos=="outside"&&h.addClass("visualize-pie-outside");var t=Math.round(u/2),n=Math.round(a/2),r=n-o.pieMargin,i=0,s=e('<ul class="visualize-labels"></ul>').insertAfter(l);e.each(y,function(u,a){var f=a<=0||isNaN(a)?0:a/v;f>0&&(x.beginPath(),x.moveTo(t,n),x.arc(t,n,r,i*Math.PI*2-Math.PI*.5,(i+f)*Math.PI*2-Math.PI*.5,!1),x.lineTo(t,n),x.closePath(),x.fillStyle=d[u].color,x.fill());var l=i+f/2,c=o.pieLabelPos=="inside"?r/1.5:r+r/5,h=Math.round(t+Math.sin(l*Math.PI*2)*c),p=Math.round(n-Math.cos(l*Math.PI*2)*c),m=h>t?"right":"left",g=p>n?"bottom":"top",y=parseFloat((f*100).toFixed(2));if(y){var b=o.pieLabelsAsPercent?y+"%":a,w=e('<span class="visualize-label">'+b+"</span>").css(m,0).css(g,0),E=e('<li class="visualize-label-pos"></li>').appendTo(s).css({left:h,top:p}).append(w);w.css("font-size",r/8).css("margin-"+m,-w.width()/2).css("margin-"+g,-w.outerHeight()/2),d[u].textColor&&w.css("color",d[u].textColor)}i+=f})},line:function(t){h.addClass(t?"visualize-area":"visualize-line");var n=l.width()/(E.length-1),r=e('<ul class="visualize-labels-x"></ul>').width(u).height(a).insertBefore(l);e.each(E,function(t){var i=e("<li><span>"+this+"</span></li>").prepend('<span class="line" />').css("left",n*t).appendTo(r),s=i.find("span:not(.line)"),o=s.width()/-2;t==0?o=0:t==E.length-1&&(o=-s.width()),s.css("margin-left",o).addClass("label")});var i=a/b,s=a/(S.length-1),f=e('<ul class="visualize-labels-y"></ul>').width(u).height(a).insertBefore(l);e.each(S,function(t){var n=e("<li><span>"+this+"</span></li>").prepend('<span class="line" />').css("bottom",s*t).prependTo(f),r=n.find("span:not(.line)"),i=r.height()/-2;t==0?i=-r.height():t==S.length-1&&(i=0),r.css("margin-top",i).addClass("label")}),x.translate(0,w),e.each(d,function(){x.beginPath(),x.lineWidth=o.lineWeight,x.lineJoin="round";var r=this.points,s=0;x.moveTo(0,-(r[0]*i)),e.each(r,function(){x.lineTo(s,-(this*i)),s+=n}),x.strokeStyle=this.color,x.stroke(),t?(x.lineTo(s,0),x.lineTo(0,0),x.closePath(),x.fillStyle=this.color,x.globalAlpha=.3,x.fill(),x.globalAlpha=1):x.closePath()})},area:function(){f.line(!0)},bar:function(){h.addClass("visualize-bar");var t=u/E.length,n=e('<ul class="visualize-labels-x"></ul>').width(u).height(a).insertBefore(l);e.each(E,function(r){var i=e('<li><span class="label">'+this+"</span></li>").prepend('<span class="line" />').css("left",t*r).width(t).appendTo(n)});var r=a/b,i=a/(S.length-1),s=e('<ul class="visualize-labels-y"></ul>').width(u).height(a).insertBefore(l);e.each(S,function(t,n){var r=e("<span>").addClass("label").html(n),o=e("<li>").css("bottom",i*t).prepend('<span class="line" />').append(r).prependTo(s);r.css("margin-top",r.height()/-2)}),x.translate(0,w),e.each(d,function(n,i){x.beginPath();var s=(t-o.barGroupMargin*2)/d.length;x.lineWidth=s-o.barMargin*2,e.each(i.points,function(e,i){var u=e*t-o.barGroupMargin+n*s+s/2;u+=o.barGroupMargin*2;var a=Math.round(-i*r);a&&(x.moveTo(u,0),x.lineTo(u,a))}),x.strokeStyle=i.color,x.stroke(),x.closePath()})}},l=e("<canvas>").attr("height",a).attr("width",u),c=o.title||s.find("caption").text(),h=(i||e("<div>")).addClass("visualize").attr("role","img").attr("aria-label","Chart representing data from the table: "+c).height(a).width(u).append(l),p=(new n(s,o)).parse(),d=p.dataGroups(),v=p.dataSum(),m=p.topValue(),g=p.bottomValue(),y=p.memberTotals(),b=p.totalYRange(),w=a*(m/b),E=p.xLabels(),S=p.yLabels(g,m);i||h.insertAfter(s),typeof G_vmlCanvasManager!="undefined"&&(G_vmlCanvasManager.init(),G_vmlCanvasManager.initElement(l[0]));var x=l[0].getContext("2d");t(f,o.type,{target:{canvasContainer:h,canvasContext:x,canvas:l},data:p,options:o});if(o.appendTitle||o.appendKey){var T=e("<div>").addClass("visualize-info").appendTo(h);o.appendTitle&&e("<div>").addClass("visualize-title").html(c).appendTo(T);if(o.appendKey){var N=e("<ul>").addClass("visualize-key");e.each(p.keys(),function(t,n){e("<li>").append(e("<span>").addClass("visualize-key-color").css("background",o.colors[t])).append(e("<span>").addClass("visualize-key-label").html(n)).appendTo(N)}),N.appendTo(T)}}e(".visualize-line li:first-child span.line, .visualize-line li:last-child span.line, .visualize-area li:first-child span.line, .visualize-area li:last-child span.line, .visualize-bar li:first-child span.line,.visualize-bar .visualize-labels-y li:last-child span.line").css("border","none"),i||h.bind("visualizeRefresh",function(){s.visualize(o,e(this).empty())})}).next()}})(jQuery),$.visualize.plugins.radar=function(){var e=this.options,t=this.target.canvasContainer,n=this.target.canvasContext,r=this.target.canvas,i=this.data.dataGroups(),s=i.length,o=this.data.memberTotals(),u=this.data.topValue();t.addClass("visualize-pie"),e.pieLabelPos=="outside"&&t.addClass("visualize-pie-outside");var a=Math.round(r.width()/2),f=Math.round(r.height()/2),l=Math.PI*2/s,c=(f<a?f:a)-e.pieMargin,h=$('<ul class="visualize-labels"></ul>').insertAfter(r);$.each(o,function(t,r){var s=r/u,o=c*s/2;n.beginPath(),n.lineWidth=e.lineWeight,n.lineJoin="round",n.moveTo(a,f),n.lineTo(a+Math.cos(t*l)*o,f+Math.sin(t*l)*o),n.strokeStyle=i[t].color,n.stroke(),n.closePath()}),n.beginPath(),n.lineWidth=1,n.lineJoin="round",n.strokeStyle=e.colors[s],n.moveTo(a+c*o[0]/u/2,f),$.each(o,function(e,t){var r=t/u,s=c*r/2,o=a+Math.cos(e*l)*s,p=f+Math.sin(e*l)*s;n.lineTo(o,p),p+=p>f?c/16:-c/16;var d=o>a?"right":"left",v=p>f?"bottom":"top",m=$("<span>").addClass("visualize-label").html(t).css(d,0).css(v,0).css("font-size",c/8).css("color",i[e].color);$("<li>").addClass("visualize-label-pos").css({left:o,top:p}).append(m).appendTo(h),m.css("margin-"+d,-m.width()/2).css("margin-"+v,-m.outerHeight()/2)}),n.closePath(),n.stroke()},function(){function t(e){var t=this.options,n=this.target.canvasContainer.addClass("visualize-bar"),r=this.target.canvasContext,i=this.target.canvas,s=this.data.dataGroups(),o=this.data.xLabels(),u=this.data.groupSums(),a=Array.max(u),f=e?this.data.yLabels100():this.data.yLabels(0,a),l=i.width()/o.length,c=$('<ul class="visualize-labels-x"></ul>').width(i.width()).height(i.height()).insertBefore(i);$.each(o,function(e,t){var n=$("<span class='label'></span>").html(t);$("<li>").css("left",l*e).width(l).prepend("<span class='line' />").append(n).appendTo(c)});var h=i.height()/(e?100:a),p=i.height()/(f.length-1),d=$('<ul class="visualize-labels-y"></ul>').width(i.width()).height(i.height()).insertBefore(i);$.each(f,function(e,t){var n=$("<span class='label'></span>").html(t);$("<li>").css("bottom",p*e).prepend("<span class='line' />").append(n).prependTo(d);var r=n.height()/-2;e==0?r=-n.height():e==f.length-1&&(r=0),n.css("margin-top",r)});var v=[];for(var m=0;m<s.length;m++){r.beginPath();var g=l-t.barGroupMargin*2;r.lineWidth=g-t.barMargin*2,r.strokeStyle=s[m].color;var y=s[m].points,b=0;for(var w=0;w<y.length;w++){typeof v[w]=="undefined"&&(v[w]=t.height);var E=b-t.barGroupMargin+g/2;E+=t.barGroupMargin*2,r.moveTo(E,v[w]),v[w]+=Math.round(-y[w]*h*(e?100/u[w]:1)),r.lineTo(E,v[w]+.1),b+=l}r.stroke(),r.closePath()}}$.visualize.plugins.pilebar=function(){t.call(this,!1)},$.visualize.plugins.pilebar_100=function(){t.call(this,!0)}}(),function(){function t(e){var t=this.options,n=this.target.canvasContainer,r=this.target.canvasContext,i=this.target.canvas,s=i.width(),o=i.height(),u=this.data.dataGroups(),a=this.data.xLabels(),f=this.data.topValue(),l=this.data.bottomValue()>0?0:this.data.bottomValue(),c=f-l,h=this.data.yLabels(l,f);n.addClass("visualize-dots");var p=s/(a.length-1),d=$('<ul class="visualize-labels-x"></ul>').width(s).height(o).insertBefore(i);$.each(a,function(e,t){var n=$("<span>").addClass("label").html(t);$("<li>").css("left",p*e).prepend("<span class='line' />").append(n).appendTo(d);var r=n.width()/-2;e==0?r=0:e==a.length-1&&(r=-n.width()),n.css("margin-left",r)});var v=o/c,m=o/(h.length-1),g=$('<ul class="visualize-labels-y"></ul>').width(s).height(o).insertBefore(i);$.each(h,function(e,t){var n=$("<span>").addClass("label").html(t);$("<li>").css("bottom",m*e).prepend("<span class='line' />").append(n).prependTo(g),n.css("margin-top",n.height()/-2)}),$.each(u,function(n,i){r.fillStyle=i.color,r.strokeStyle=i.color,r.lineWidth=t.lineWeight,r.lineJoin="round",$.each(i.points,function(t,n){r.beginPath();var s=e?i.points_weight[t]:1;r.arc(t*p,-n*v+o,s,0,2*Math.PI,!1),r.fill(),r.stroke()})})}$.visualize.plugins.dots=function(){t.call(this,!1)},$.visualize.plugins.dots_w=function(){t.call(this,!0)}}(),function(){$.visualize.plugins.hbar=function(){var e=this.options,t=this.target.canvasContainer.addClass("visualize-hbar"),n=this.target.canvasContext,r=this.target.canvas,i=r.width(),s=r.height(),o=this.data,u=e.parseDirection=="x"?o.lines:o.columns,a=$.map(u,Array.max),f=Array.max(a),l=$.visualize.getRangeLabels(0,f,5),c=e.parseDirection=="x"?o.columnHeaders:o.lineHeaders,h=$("<ul>").addClass("visualize-labels-x").width(i).height(s).insertBefore(r);n.beginPath(),n.lineWidth=.1;var p=i/(l.length-1);$.each(l,function(e,t){var r=$("<span>").addClass("label").html(t);$("<li>").css("left",p*e).width(p).append(r).appendTo(h),e>0&&r.css("margin-left",-0.5*r.width()),n.moveTo(p*(e+1),0),n.lineTo(p*(e+1),s)}),n.strokeStyle="#fff",n.stroke(),n.closePath();var d=$("<ul>").addClass("visualize-labels-y").width(i).height(s).insertBefore(r);n.beginPath(),n.lineWidth=.1;var v=s/c.length;$.each(c,function(e,t){var r=$("<span>").addClass("label").html(t);$("<li>").css({top:v*e+v/2,height:v/2}).append(r).appendTo(d),r.css("margin-top",-0.5*r.height()),n.moveTo(0,v*(e+1)),n.lineTo(i,v*(e+1))}),n.strokeStyle="#fff",n.stroke(),n.closePath();var m=i/f,g=s/c.length;for(var y=0;y<u.length;y++){n.beginPath();var b=(g-e.barGroupMargin*2)/u.length;n.lineWidth=b-e.barMargin*2;var w=u[y];for(var E=0;E<w.length;E++){var S=E*g+e.barGroupMargin+y*b+b/2;n.moveTo(0,S),n.lineTo(Math.round(w[E]*m)+.1,S)}n.strokeStyle=e.colors[y],n.stroke(),n.closePath()}}}(),function(){var t={normalize:!1,ticks:7};$.visualize.plugins.hstack_100=function(){this.options.normalize=!0,this.options.ticks=5,n.call(this)};var n=$.visualize.plugins.hstack=function(){var e=$.extend(t,this.options),n=this.target.canvasContainer.addClass("visualize-hstack"),r=this.target.canvasContext,i=this.target.canvas,s=i.width(),o=i.height(),u=this.data,a=e.parseDirection=="x"?u.lines:u.columns,f=$.map(a,Array.sum),l=e.normalize?100:Array.max(f),c=$.visualize.getRangeLabels(0,l,e.ticks),h=e.parseDirection=="x"?u.lineHeaders:u.columnHeaders;this.data.keys=e.parseDirection=="x"?function(){return u.columnHeaders}:function(){return u.lineHeaders};var p=s/(c.length-1),d=$("<ul>").addClass("visualize-labels-x").width(s).height(o).insertBefore(i);r.beginPath(),r.lineWidth=.1,$.each(c,function(e,t){var n=$("<span>").addClass("label").html(t);$("<li>").css("left",p*e).width(p).append(n).appendTo(d),n.css(e==0?{"text-align":"left"}:{"margin-left":-0.5*n.width()}),r.moveTo(p*(e+1),0),r.lineTo(p*(e+1),o)}),r.strokeStyle="#fff",r.stroke(),r.closePath();var v=$("<ul>").addClass("visualize-labels-y").width(s).height(o).insertBefore(i);r.beginPath(),r.lineWidth=.1;var m=o/h.length;$.each(h,function(e,t){var n=$("<span>").addClass("label").html(t);$("<li>").css("bottom",m*e+m/2).append(n).prependTo(v),n.css("margin-top",n.height()/-2),r.moveTo(0,o-m*e),r.lineTo(s,o-m*e)}),r.strokeStyle="#fff",r.stroke(),r.closePath();var g=s/l,y=o/h.length;for(var b=0;b<a.length;b++){r.lineWidth=y-(e.barMargin+e.barGroupMargin)*2;var w=a[b],E=0,S=o-y*b-y/2,x=e.normalize?100/Array.sum(w):1;for(var T=0;T<w.length;T++){var N=Math.round(w[T]*g*x);r.beginPath(),r.strokeStyle=e.colors[T],r.moveTo(E,S),r.lineTo(E+N,S),r.stroke(),r.closePath(),E+=N}}}}