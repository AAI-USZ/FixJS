function(a,b,c){if(!(c==128||c==192||c==256))return"";for(var a=Utf8.encode(a),b=Utf8.encode(b),d=c/8,e=Array(d),c=0;c<d;c++)e[c]=isNaN(b.charCodeAt(c))?0:b.charCodeAt(c);for(var e=Aes.cipher(e,Aes.keyExpansion(e)),e=e.concat(e.slice(0,d-16)),b=Array(16),c=(new Date).getTime(),d=c%1E3,f=Math.floor(c/1E3),j=Math.floor(Math.random()*65535),c=0;c<2;c++)b[c]=d>>>c*8&255;for(c=0;c<2;c++)b[c+2]=j>>>c*8&255;for(c=0;c<4;c++)b[c+4]=f>>>c*8&255;d="";for(c=0;c<8;c++)d=d+String.fromCharCode(b[c]);
for(var e=Aes.keyExpansion(e),f=Math.ceil(a.length/16),j=Array(f),g=0;g<f;g++){for(c=0;c<4;c++)b[15-c]=g>>>c*8&255;for(c=0;c<4;c++)b[15-c-4]=g/4294967296>>>c*8;for(var h=Aes.cipher(b,e),n=g<f-1?16:(a.length-1)%16+1,p=Array(n),c=0;c<n;c++){p[c]=h[c]^a.charCodeAt(g*16+c);p[c]=String.fromCharCode(p[c])}j[g]=p.join("")}a=d+j.join("");return a=Base64.encode(a)}