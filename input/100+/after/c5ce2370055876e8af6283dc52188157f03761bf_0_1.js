function(b,c){var d,e,f;return f=this,d=""+this.options.uuid+"-image-dialog",b.append(a('<li id="'+this.options.uuid+'-tab-search" class="'+f.widgetName+"-tabselector "+f.widgetName+'-tab-search"><span>Search</span></li>')),e=a('<div id="'+this.options.uuid+'-tab-search-content" class="'+f.widgetName+'-tab tab-search"></div>'),c.append(e),e.halloimagesearch({uuid:this.options.uuid,imageWidget:this,searchCallback:this.options.search,searchUrl:this.options.searchUrl,limit:this.options.limit,entity:this.options.entity})},_addGuiTabUpload:function(b,c){var d;return b.append(a('<li id="'+this.options.uuid+'-tab-upload" class="'+this.widgetName+"-tabselector "+this.widgetName+'-tab-upload"><span>Upload</span></li>')),d=a('<div id="'+this.options.uuid+'-tab-upload-content" class="'+this.widgetName+'-tab tab-upload"></div>'),c.append(d),d.halloimageupload({uuid:this.options.uuid,uploadCallback:this.options.upload,uploadUrl:this.options.uploadUrl,imageWidget:this,entity:this.options.entity})}})}(jQuery),function(a){return a.widget("IKS.halloformat",{options:{editable:null,uuid:"",formattings:{bold:!0,italic:!0,strikeThrough:!1,underline:!1},buttonCssClass:null},populateToolbar:function(b){var c,d,e,f,g,h,i=this;g=this,d=a('<span class="'+g.widgetName+'"></span>'),c=function(b){var c;return c=a("<span></span>"),c.hallobutton({label:b,editable:i.options.editable,command:b,uuid:i.options.uuid,cssClass:i.options.buttonCssClass}),d.append(c)},h=this.options.formattings;for(f in h)e=h[f],e&&c(f);return d.buttonset(),b.append(d)}})}(jQuery),function(a){return a.widget("IKS.halloreundo",{options:{editable:null,toolbar:null,uuid:"",buttonCssClass:null},populateToolbar:function(b){var c,d,e=this;return d=a('<span class="'+this.widgetName+'"></span>'),c=function(b,c){var f;return f=a("<span></span>"),f.hallobutton({uuid:e.options.uuid,editable:e.options.editable,label:c,icon:b==="undo"?"icon-undo":"icon-repeat",command:b,queryState:!1,cssClass:e.options.buttonCssClass}),d.append(f)},c("undo","Undo"),c("redo","Redo"),d.buttonset(),b.append(d)},_init:function(){}})}(jQuery),function(a){return a.widget("IKS.halloblock",{options:{editable:null,toolbar:null,uuid:"",elements:["h1","h2","h3","p","pre","blockquote"],buttonCssClass:null},populateToolbar:function(b){var c,d,e;return c=a('<span class="'+this.widgetName+'"></span>'),d=""+this.options.uuid+"-"+this.widgetName+"-data",e=this._prepareDropdown(d),c.append(e),c.append(this._prepareButton(e)),b.append(c)},_prepareDropdown:function(b){var c,d,e,f,g,h,i,j=this;e=a('<div id="'+b+'"></div>'),d=this.options.editable.element.get(0).tagName.toLowerCase(),c=function(b){var c,e;return c=a("<"+b+' class="menu-item">'+b+"</"+b+">"),d===b&&c.addClass("selected"),d!=="div"&&c.addClass("disabled"),c.bind("click",function(){if(c.hasClass("disabled"))return;return j.options.editable.execute("formatBlock",b.toUpperCase())}),e=function(a){var d;d=document.queryCommandValue("formatBlock");if(d.toLowerCase()===b){c.addClass("selected");return}return c.removeClass("selected")},j.options.editable.element.bind("halloenabled",function(){return j.options.editable.element.bind("keyup paste change mouseup",e)}),j.options.editable.element.bind("hallodisabled",function(){return j.options.editable.element.unbind("keyup paste change mouseup",e)}),c},i=this.options.elements;for(g=0,h=i.length;g<h;g++)f=i[g],e.append(c(f));return e},_prepareButton:function(b){var c;return c=a("<span></span>"),c.hallodropdownbutton({uuid:this.options.uuid,editable:this.options.editable,label:"block",icon:"icon-text-height",target:b,cssClass:this.options.buttonCssClass}),c}})}(jQuery),function(a){return a.widget("IKS.hallolink",{options:{editable:null,uuid:"",link:!0,image:!0,defaultUrl:"http://",dialogOpts:{autoOpen:!1,width:540,height:95,title:"Enter Link",modal:!0,resizable:!1,draggable:!1,dialogClass:"hallolink-dialog"},butonCssClass:null},populateToolbar:function(b){var c,d,e,f,g,h,i,j=this;i=this,f=""+this.options.uuid+"-dialog",e=a('<div id="'+f+'"><form action="#" method="post" class="linkForm"><input class="url" type="text" name="url" value="'+this.options.defaultUrl+'" /><input type="submit" id="addlinkButton" value="Insert" /></form></div>'),h=a("input[name=url]",e).focus(function(a){return this.select()}),g=function(a){var b;return a.preventDefault(),b=h.val(),i.options.editable.restoreSelection(i.lastSelection),(new RegExp(/^\s*$/)).test(b)||b===i.options.defaultUrl?(i.lastSelection.collapsed&&(i.lastSelection.setStartBefore(i.lastSelection.startContainer),i.lastSelection.setEndAfter(i.lastSelection.startContainer),window.getSelection().addRange(i.lastSelection)),document.execCommand("unlink",null,"")):i.lastSelection.startContainer.parentNode.href===void 0?document.execCommand("createLink",null,b):i.lastSelection.startContainer.parentNode.href=b,i.options.editable.element.trigger("change"),i.options.editable.removeAllSelections(),e.dialog("close"),!1},e.find("form").submit(g),d=a('<span class="'+i.widgetName+'"></span>'),c=function(b){var c,f,g;return g=""+j.options.uuid+"-"+b,f=a("<span></span>"),f.hallobutton({label:"Link",icon:"icon-link",editable:j.options.editable,command:null,queryState:!1,uuid:j.options.uuid,cssClass:j.options.buttonCssClass}),d.append(f),c=f,c.bind("change",function(b){return i.lastSelection=i.options.editable.getSelection(),h=a("input[name=url]",e),i.lastSelection.startContainer.parentNode.href===void 0?h.val(i.options.defaultUrl):(h.val(a(i.lastSelection.startContainer.parentNode).attr("href")),a(h[0].form).find("input[type=submit]").val("update")),i.options.editable.keepActivated(!0),e.dialog("open"),e.bind("dialogclose",function(){return a("label",f).removeClass("ui-state-active"),i.options.editable.element.focus(),i.options.editable.keepActivated(!1)})}),j.element.bind("keyup paste change mouseup",function(b){var d,e;e=a(i.options.editable.getSelection().startContainer),d=e.prop("nodeName")?e.prop("nodeName"):e.parent().prop("nodeName");if(d&&d.toUpperCase()==="A"){a("label",c).addClass("ui-state-active");return}return a("label",c).removeClass("ui-state-active")})},this.options.link&&c("A");if(this.options.link)return d.buttonset(),b.append(d),e.dialog(this.options.dialogOpts)},_init:function(){}})}(jQuery),function(a){return a.widget("IKS.hallojustify",{options:{editable:null,toolbar:null,uuid:"",buttonCssClass:null},populateToolbar:function(b){var c,d,e=this;return d=a('<span class="'+this.widgetName+'"></span>'),c=function(b){var c;return c=a("<span></span>"),c.hallobutton({uuid:e.options.uuid,editable:e.options.editable,label:b,command:"justify"+b,icon:"icon-align-"+b.toLowerCase(),cssClass:e.options.buttonCssClass}),d.append(c)},c("Left"),c("Center"),c("Right"),d.buttonset(),b.append(d)},_init:function(){}})}(jQuery),function(a){return a.widget("IKS.hallobutton",{button:null,options:{uuid:"",label:null,icon:null,editable:null,command:null,queryState:!0,cssClass:null},_create:function(){var a,b,c;return(c=(b=this.options).icon)==null&&(b.icon="icon-"+this.options.label.toLowerCase()),a=""+this.options.uuid+"-"+this.options.label,this.element.append(this._createButton(a,this.options.command)),this.element.append(this._createLabel(a,this.options.command,this.options.label,this.options.icon)),this.options.cssClass&&this.element.find("label").addClass(this.options.cssClass),this.button=this.element.find("input"),this.button.button(),this.options.cssClass&&this.button.addClass(this.options.cssClass),this.options.editable.options.touchScreen&&this.button.addClass("btn-large"),this.button.data("hallo-command",this.options.command)},_init:function(){var a,b,c=this;this.button||(this.button=this._prepareButton()),this.element.append(this.button),this.options.command&&this.button.bind("change",function(a){return c.options.editable.execute(c.options.command)});if(!this.options.queryState)return;return a=this.options.editable.element,b=function(a){if(!c.options.command)return;try{return c.checked(document.queryCommandState(c.options.command))}catch(b){}},a.bind("keyup paste change mouseup hallomodified",b),a.bind("halloenabled",function(){return a.bind("keyup paste change mouseup hallomodified",b)}),a.bind("hallodisabled",function(){return a.unbind("keyup paste change mouseup hallomodified",b)})},enable:function(){return this.button.button("enable")},disable:function(){return this.button.button("disable")},refresh:function(){return this.button.button("refresh")},checked:function(a){return this.button.attr("checked",a),this.refresh()},_createButton:function(b){return a('<input id="'+b+'" type="checkbox" />')},_createLabel:function(b,c,d,e){return a('<label for="'+b+'" class="'+c+'_button" title="'+d+'"><i class="'+e+'"></i></label>')}})}(jQuery),function(a){return a.widget("IKS.hallodropdownbutton",{button:null,options:{uuid:"",label:null,icon:null,editable:null,target:"",cssClass:null},_create:function(){var a,b;return(b=(a=this.options).icon)!=null?b:a.icon="icon-"+this.options.label.toLowerCase()},_init:function(){var b,c=this;return b=a(this.options.target),b.css("position","absolute"),b.addClass("dropdown-menu"),b.hide(),this.button||(this.button=this._prepareButton()),this.button.bind("click",function(){if(b.hasClass("open")){c._hideTarget();return}return c._showTarget()}),b.bind("click",function(){return c._hideTarget()}),this.options.editable.element.bind("hallodeactivated",function(){return c._hideTarget()}),this.element.append(this.button)},_showTarget:function(){var b;return b=a(this.options.target),this._updateTargetPosition(),b.addClass("open"),b.show()},_hideTarget:function(){var b;return b=a(this.options.target),b.removeClass("open"),b.hide()},_updateTargetPosition:function(){var b,c,d,e;return d=a(this.options.target),e=this.element.position(),b=e.bottom,c=e.left,d.css("top",b),d.css("left",c-20)},_prepareButton:function(){var b,c,d;return d=""+this.options.uuid+"-"+this.options.label,c=a('<button id="'+d+'" data-toggle="dropdown" data-target="#'+this.options.target.attr("id")+'" title="'+this.options.label+'">\n  <span class="ui-button-text"><i class="'+this.options.icon+'"></i></span>\n</button>'),this.options.cssClass&&c.addClass(this.options.cssClass),b=c.button(),b}})}(jQuery),function(a){return a.widget("Hallo.halloToolbarContextual",{toolbar:null,options:{parentElement:"body",editable:null,toolbar:null},_create:function(){var b=this;return this.toolbar=this.options.toolbar,a(this.options.parentElement).append(this.toolbar),this._bindEvents(),a(window).resize(function(a){return b._updatePosition(b._getPosition(a))})},_getPosition:function(a,b){var c;if(!a)return;if(a.originalEvent instanceof KeyboardEvent)return this._getCaretPosition(b);if(a.originalEvent instanceof MouseEvent)return c={top:a.pageY,left:a.pageX}},_getCaretPosition:function(b){var c,d,e;return e=a("<span/>"),c=document.createRange(),c.setStart(b.endContainer,b.endOffset),c.insertNode(e.get(0)),d={top:e.offset().top,left:e.offset().left},e.remove(),d},setPosition:function(){return this.options.parentElement!=="body"&&(this.options.parentElement="body",a(this.options.parentElement).append(this.toolbar)),this.toolbar.css("position","absolute"),this.toolbar.css("top",this.element.offset().top-20),this.toolbar.css("left",this.element.offset().left)},_updatePosition:function(a){if(!a)return;if(!a.top||!a.left)return;return this.toolbar.css("top",a.top),this.toolbar.css("left",a.left)},_bindEvents:function(){var a=this;return this.element.bind("halloselected",function(b,c){var d;d=a._getPosition(c.originalEvent,c.selection);if(!d)return;return a._updatePosition(d),a.toolbar.show()}),this.element.bind("hallounselected",function(b,c){return a.toolbar.hide()}),this.element.bind("hallodeactivated",function(b,c){return a.toolbar.hide()})}})}(jQuery),function(a){return a.widget("Hallo.halloToolbarFixed",{toolbar:null,options:{parentElement:"body",editable:null,toolbar:null},_create:function(){var b,c,d=this;this.toolbar=this.options.toolbar,this.toolbar.show(),a(this.options.parentElement).append(this.toolbar),this._bindEvents(),a(window).resize(function(a){return d._updatePosition(d._getPosition(a))});if(this.options.parentElement==="body"&&!this.options.floating)return b=a(this.element),c=parseFloat(b.css("padding-left")),c+=parseFloat(b.css("padding-right")),c+=parseFloat(b.css("border-left-width")),c+=parseFloat(b.css("border-right-width")),c+=parseFloat(b.css("outline-width"))*2,c+=parseFloat(b.css("outline-offset"))*2,a(this.toolbar).css("width",b.width()+c)},_getPosition:function(a,b){var c,d;if(!a)return;return c=parseFloat(this.element.css("outline-width"))+parseFloat(this.element.css("outline-offset")),d={top:this.element.offset().top-this.toolbar.outerHeight()-c,left:this.element.offset().left-c}},_getCaretPosition:function(b){var c,d,e;return e=a("<span/>"),c=document.createRange(),c.setStart(b.endContainer,b.endOffset),c.insertNode(e.get(0)),d={top:e.offset().top,left:e.offset().left},e.remove(),d},setPosition:function(){if(this.options.parentElement!=="body")return;return this.toolbar.css("position","absolute"),this.toolbar.css("top",this.element.offset().top-this.toolbar.outerHeight()),this.toolbar.css("left",this.element.offset().left)},_updatePosition:function(a){},_bindEvents:function(){var a=this;return this.element.bind("halloactivated",function(b,c){return a._updatePosition(a._getPosition(b)),a.toolbar.show()}),this.element.bind("hallodeactivated",function(b,c){return a.toolbar.hide()})}