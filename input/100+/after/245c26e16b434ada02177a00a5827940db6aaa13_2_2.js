function(x){x.name="mustache.js";x.version="0.5.0-dev";x.tags=["{{","}}"];x.parse=n;x.compile=e;x.render=w;x.clearCache=v;x.to_html=function(B,z,A,C){var y=w(B,z,A);if(typeof C==="function"){C(y)}else{return y}};var t=Object.prototype.toString;var f=Array.isArray;var b=Array.prototype.forEach;var g=String.prototype.trim;var j;if(f){j=f}else{j=function(y){return t.call(y)==="[object Array]"}}var s;if(b){s=function(z,A,y){return b.call(z,A,y)}}else{s=function(B,C,A){for(var z=0,y=B.length;z<y;++z){C.call(A,B[z],z,B)}}}var l=/^\s*$/;function c(y){return l.test(y)}var q;if(g){q=function(y){return y==null?"":g.call(y)}}else{var o,h;if(c("\xA0")){o=/^\s+/;h=/\s+$/}else{o=/^[\s\xA0]+/;h=/[\s\xA0]+$/}q=function(y){return y==null?"":String(y).replace(o,"").replace(h,"")}}var d={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};function p(y){return String(y).replace(/[&<>"'\/]/g,function(z){return d[z]||z})}function m(E,G,H,A){A=A||"<template>";var I=G.split("\n"),y=Math.max(H-3,0),B=Math.min(I.length,H+3),z=I.slice(y,B);var F;for(var C=0,D=z.length;C<D;++C){F=C+y+1;z[C]=(F===H?" >> ":"    ")+z[C]}E.template=G;E.line=H;E.file=A;E.message=[A+":"+H,z.join("\n"),"",E.message].join("\n");return E}function u(y,G,F){if(y==="."){return G[G.length-1]}var E=y.split(".");var C=E.length-1;var D=E[C];var H,z,B=G.length,A,I;while(B){I=G.slice(0);z=G[--B];A=0;while(A<C){z=z[E[A++]];if(z==null){break}I.push(z)}if(z&&typeof z==="object"&&D in z){H=z[D];break}}if(typeof H==="function"){H=H.call(I[I.length-1])}if(H==null){return F}return H}function k(B,y,F,A){var z="";var D=u(B,y);if(A){if(D==null||D===false||(j(D)&&D.length===0)){z+=F()}}else{if(j(D)){s(D,function(G){y.push(G);z+=F();y.pop()})}else{if(typeof D==="object"){y.push(D);z+=F();y.pop()}else{if(typeof D==="function"){var C=y[y.length-1];var E=function(G){return w(G,C)};z+=D.call(C,F(),E)||""}else{if(D){z+=F()}}}}}return z}function n(ab,C){C=C||{};var M=C.tags||x.tags,N=M[0],H=M[M.length-1];var z=['var buffer = "";',"\nvar line = 1;","\ntry {",'\nbuffer += "'];var G=[],ac=false,Z=false;var X=function(){if(ac&&!Z&&!C.space){while(G.length){z.splice(G.pop(),1)}}else{G=[]}ac=false;Z=false};var U=[],R,D,O;var W=function(ad){M=q(ad).split(/\s+/);D=M[0];O=M[M.length-1]};var K=function(ad){z.push('";',R,'\nvar partial = partials["'+q(ad)+'"];',"\nif (partial) {","\n  buffer += render(partial,stack[stack.length - 1],partials);","\n}",'\nbuffer += "')};var y=function(af,ad){var ae=q(af);if(ae===""){throw m(new Error("Section name may not be empty"),ab,J,C.file)}U.push({name:ae,inverted:ad});z.push('";',R,'\nvar name = "'+ae+'";',"\nvar callback = (function () {","\n  return function () {",'\n    var buffer = "";','\nbuffer += "')};var F=function(ad){y(ad,true)};var V=function(ae){var ad=q(ae);var ag=U.length!=0&&U[U.length-1].name;if(!ag||ad!=ag){throw m(new Error('Section named "'+ad+'" was never opened'),ab,J,C.file)}var af=U.pop();z.push('";',"\n    return buffer;","\n  };","\n})();");if(af.inverted){z.push("\nbuffer += renderSection(name,stack,callback,true);")}else{z.push("\nbuffer += renderSection(name,stack,callback);")}z.push('\nbuffer += "')};var Y=function(ad){z.push('";',R,'\nbuffer += lookup("'+q(ad)+'",stack,"");','\nbuffer += "')};var A=function(ad){z.push('";',R,'\nbuffer += escapeHTML(lookup("'+q(ad)+'",stack,""));','\nbuffer += "')};var J=1,aa,E;for(var S=0,T=ab.length;S<T;++S){if(ab.slice(S,S+N.length)===N){S+=N.length;aa=ab.substr(S,1);R="\nline = "+J+";";D=N;O=H;ac=true;switch(aa){case"!":S++;E=null;break;case"=":S++;H="="+H;E=W;break;case">":S++;E=K;break;case"#":S++;E=y;break;case"^":S++;E=F;break;case"/":S++;E=V;break;case"{":H="}"+H;case"&":S++;Z=true;E=Y;break;default:Z=true;E=A}var B=ab.indexOf(H,S);if(B===-1){throw m(new Error('Tag "'+N+'" was not closed properly'),ab,J,C.file)}var Q=ab.substring(S,B);if(E){E(Q)}var P=0;while(~(P=Q.indexOf("\n",P))){J++;P++}S=B+H.length-1;N=D;H=O}else{aa=ab.substr(S,1);switch(aa){case'"':case"\\":Z=true;z.push("\\"+aa);break;case"\r":break;case"\n":G.push(z.length);z.push("\\n");X();J++;break;default:if(c(aa)){G.push(z.length)}else{Z=true}z.push(aa)}}}if(U.length!=0){throw m(new Error('Section "'+U[U.length-1].name+'" was not closed properly'),ab,J,C.file)}X();z.push('";',"\nreturn buffer;","\n} catch (e) { throw {error: e, line: line}; }");var I=z.join("").replace(/buffer \+= "";\n/g,"");if(C.debug){if(typeof console!="undefined"&&console.log){console.log(I)}else{if(typeof print==="function"){print(I)}}}return I}function r(C,A){var z="view,partials,stack,lookup,escapeHTML,renderSection,render";var y=n(C,A);var B=new Function(z,y);return function(E,F){F=F||{};var D=[E];try{return B(E,F,D,u,p,k,w)}catch(G){throw m(G.error,C,G.line,A.file)}}}var a={};function v(){a={}}function e(z,y){y=y||{};if(y.cache!==false){if(!a[z]){a[z]=r(z,y)}return a[z]}return r(z,y)}function w(A,y,z){return e(A)(y,z)}}